<!DOCTYPE html>
<html lang="zh-Hant">
  <head>
    <meta charset="utf-8">
    <title>產生物體</title>
    <style>
      body { margin: 0; overflow: hidden; background: black; }
      #ui {
        position: absolute;
        top: 10px;
        left: 10px;
        background: rgba(255, 255, 255, 0.9);
        padding: 12px;
        border-radius: 8px;
        font-family: sans-serif;
        z-index: 10;
      }
      .parm-group {
        margin-bottom: 10px;
      }
      .parm-group input {
        margin: 2px 0 ;
        display: block;
        width: 100px;
      }
      label { display: block; margin: 5px 0; }
      input[type="number"] { width: 80px; }
      #video {
        position: absolute;
        bottom: 10px;
        right: 10px;
        width: 200px;
        height: 150px;
        border: 2px solid #00ff00;
        background-color: black;
        z-index: 5;
      }
    </style>
  </head>
  <body>
    <div id="ui">
        <label>
            選擇圖形：
            <select id="shapeType">
                <option value="cube">立方體</option>
                <option value="circle">球體</option>
                <option value="lshape">不規則圖形</option>
            </select>
        </label>
        <div id="boxParams" class="param-group">
            <input id="boxWidth" type="number" placeholder="寬 (Width)" />
            <input id="boxHeight" type="number" placeholder="高 (Height)" />
            <input id="boxDepth" type="number" placeholder="深 (Depth)" />
        </div>

        <div id="sphereParams" class="param-group" style="display:none;">
            <input id="sphereWidth" type="number" placeholder="直徑 (Diameter)" />
        </div>

        <div id="customParams" class="param-group" style="display:none;">
            <input id="customWidth" type="number" placeholder="寬 (Width)" />
            <input id="customHeight" type="number" placeholder="高 (Height)" />
            <input id="customDepth" type="number" placeholder="厚度 (Depth)" />
        </div>

        <label>
            顏色：
            <input id="color" type="color" value="#00ff00" />
        </label>

        <label>
            <input type="checkbox" id="hasHole" /> 是否簍空
        </label>

        <div id="holeInput" style="display:none;">
            <input id="holeWidth" type="number" placeholder="孔寬 (Hole Width)" />
            <input id="holeHeight" type="number" placeholder="孔高 (Hole Height)" />
        </div>
        <button id="generate">產生物體</button>
        <button id="recognizeBtn">辨識參數</button>


    </div>

    <video id="video" autoplay muted playsinline></video>

    <script type="module">
      import { createRecognizer } from './recognizer.js';
      //import { createCube } from './main.js';
      const video = document.getElementById('video');
      const recognize = await createRecognizer(video);
      document.getElementById('recognizeParams').addEventListener('click', async () => {
        await recognize((data) => {
          if (!data) return;
          const {
            type, width, height, depth,
            color, hasHole, holeWidth, holeHeight
          } = data;

          document.getElementById('shapeType').value = type;
          document.getElementById('shapeType').dispatchEvent(new Event('change'));
          document.getElementById('color').value = color;
          document.getElementById('hasHole').checked = hasHole;
          document.getElementById('hasHole').dispatchEvent(new Event('change'));
          //document.getElementById('holeInput').style.display = hasHole ? 'block' : 'none';

          if (type === 'cube') {
            document.getElementById('boxWidth').value = width;
            document.getElementById('boxHeight').value = height;
            document.getElementById('boxDepth').value = depth;
          } else if (type === 'circle') {
            document.getElementById('sphereWidth').value = width;
          } else if (type === 'lshape') {
            document.getElementById('customWidth').value = width;
            document.getElementById('customHeight').value = height;
            document.getElementById('customDepth').value = depth;
          }

          document.getElementById('holeWidth').value = holeWidth;
          document.getElementById('holeHeight').value = holeHeight;
        });
      });
    </script>
    <script type="module" src="/main.js"></script>
  </body>
</html>